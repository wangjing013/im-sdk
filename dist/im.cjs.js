"use strict";var e,t=(e=require("@yxim/nim-web-sdk"))&&"object"==typeof e&&"default"in e?e.default:e,n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};var o=function(){return o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};var r,i,c,s,a=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,o,i,c){if("function"!=typeof o)throw new TypeError("The listener must be a function");var s=new r(o,i||e,c),a=n?n+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],s]:e._events[a].push(s):(e._events[a]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,o,r=[];if(0===this._eventsCount)return r;for(o in e=this._events)t.call(e,o)&&r.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,i=o.length,c=new Array(i);r<i;r++)c[r]=o[r].fn;return c},s.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},s.prototype.emit=function(e,t,o,r,i,c){var s=n?n+e:e;if(!this._events[s])return!1;var a,u,f=this._events[s],p=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,o),!0;case 4:return f.fn.call(f.context,t,o,r),!0;case 5:return f.fn.call(f.context,t,o,r,i),!0;case 6:return f.fn.call(f.context,t,o,r,i,c),!0}for(u=1,a=new Array(p-1);u<p;u++)a[u-1]=arguments[u];f.fn.apply(f.context,a)}else{var m,l=f.length;for(u=0;u<l;u++)switch(f[u].once&&this.removeListener(e,f[u].fn,void 0,!0),p){case 1:f[u].fn.call(f[u].context);break;case 2:f[u].fn.call(f[u].context,t);break;case 3:f[u].fn.call(f[u].context,t,o);break;case 4:f[u].fn.call(f[u].context,t,o,r);break;default:if(!a)for(m=1,a=new Array(p-1);m<p;m++)a[m-1]=arguments[m];f[u].fn.apply(f[u].context,a)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,o,r){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||o&&s.context!==o||c(this,i);else{for(var a=0,u=[],f=s.length;a<f;a++)(s[a].fn!==t||r&&!s[a].once||o&&s[a].context!==o)&&u.push(s[a]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})),u={log:console.log,info:console.info,error:console.error};!function(e){e.in="in",e.out="out"}(r||(r={})),function(e){e.Android="Android",e.iOS="iOS",e.PC="PC",e.Web="Web",e.Mac="Mac"}(i||(i={})),function(e){e.text="text",e.image="image",e.audio="audio",e.video="video",e.file="file",e.geo="geo",e.custom="custom",e.tip="tip",e.notification="notification"}(c||(c={})),function(e){e.memberEnter="memberEnter",e.memberExit="memberExit",e.addManager="addManager",e.removeManager="removeManager",e.addCommon="addCommon",e.removeCommon="removeCommon",e.blackMember="blackMember",e.unblackMember="unblackMember",e.gagMember="gagMember",e.ungagMember="ungagMember",e.kickMember="kickMember",e.updateChatroom="updateChatroom",e.updateMemberInfo="updateMemberInfo",e.addTempMute="addTempMute",e.removeTempMute="removeTempMute",e.muteRoom="muteRoom",e.unmuteRoom="unmuteRoom"}(s||(s={}));var f={Chatroom:function(e){function r(n){var r=e.call(this)||this;return r.chatroom=t.Chatroom.getInstance(o(o({},n),{onconnect:function(){},onwillreconnect:function(){},ondisconnect:function(){},onerror:function(){},onmsgs:function(e){e.forEach((function(e){var t=e.type;if(t===c.text);else if(t===c.image);else if(t===c.audio);else if(t===c.video);else if(t===c.file);else if(t===c.geo);else if(t===c.tip);else if(t===c.notification){switch(e.attach.type){case s.memberEnter:case s.memberExit:case s.blackMember:case s.unblackMember:case s.gagMember:case s.ungagMember:case s.muteRoom:case s.unmuteRoom:case s.updateChatroom:}}else t===c.custom||u.info("未知消息")}))}})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(r,e),r.getInstance=function(e){return void 0===r.instance&&(r.instance=new r(o({},e))),r.instance},r.prototype.setOptions=function(e){this.chatroom.setOptions(e)},r.prototype.getChatroom=function(){var e=this;return new Promise((function(t,n){e.chatroom.getChatroom({done:function(e,o){e?n(e):t(o)}})}))},r.prototype.connect=function(){r.instance.connect()},r.prototype.disconnect=function(){r.instance.disconnect()},r.prototype.destroy=function(){var e=this;return new Promise((function(t,n){e.chatroom.destroy({done:function(e){e?n(e):t(!0)}})}))},r.EVENTS=s,r}(a)};module.exports=f;
